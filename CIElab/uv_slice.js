var canvas=document.getElementById("uv_slice"),canvas_bg=document.getElementById("uv_slice_bg"),select_point_list=document.getElementById("select"),c=canvas.getContext("2d"),c_bg=canvas_bg.getContext("2d"),l_value=50,selected_point_index=-1,select_point_radius=4,draw_smooth=!1;check_browser();var width=0,height=0,screen_width=window.screen.availWidth;screen_width>1900?(height=800,width=1800):screen_width>1200?(height=520,width=1170):(height=400,width=900),canvas.width=Math.ceil(width/2.5),canvas.height=canvas.width,canvas.width=400,canvas.height=400,canvas_bg.width=400,canvas_bg.height=400;var mouse_pressed=!1;function getColorForAB(e,t){return rgb=labTOrgb([l_value,e,t]),isValidRGB(rgb)||(rgb[0]=rgb[1]=rgb[2]=.4),rgb=convertToIntRGB(rgb),"rgb( "+rgb[0]+", "+rgb[1]+", "+rgb[2]+")"}function check_browser(){navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Firefox")>-1&&(select_point_list.size=18)}canvas.addEventListener("mousemove",function(e){var t=canvas.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top;if(mouse_pressed&&selected_point_index>-1){var l=JSON.parse(JSON.stringify(point_list[selected_point_index]));if(point_list[selected_point_index].xy[0]=i,point_list[selected_point_index].xy[1]=n,point_list[selected_point_index].lab[1]=getA(i),point_list[selected_point_index].lab[2]=getB(n),point_list[selected_point_index].rgb=labTOrgb(point_list[selected_point_index].lab),point_lies_inside_boundry(point_list[selected_point_index]));else point_list[selected_point_index]=l;select_point_list[selected_point_index].innerHTML="&nbspL:"+point_list[selected_point_index].lab[0].toFixed(1)+",&nbsp&nbsp R:"+point_list[selected_point_index].rgb[0].toFixed(3)+",&nbsp&nbsp G:"+point_list[selected_point_index].rgb[1].toFixed(3)+",&nbsp&nbsp B:"+point_list[selected_point_index].rgb[2].toFixed(3)+"&nbsp&nbsp",c.clearRect(0,0,canvas.width,canvas.height),draw_points(),draw_color_pattern(),draw_graph()}c_bg.font="10pt Calibri",c_bg.fillStyle="black",c_bg.fillRect(0,0,60,20),c_bg.fillStyle="white",c_bg.fillText(Math.floor(i)+", "+Math.floor(n),2,13)},!1),canvas.addEventListener("click",function(e){var t=canvas.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top;lab=[l_value,getA(i),getB(n)],rgb=labTOrgb(lab);var l={};l.xy=[i,n],l.lab=lab,l.rgb=rgb,ind=point_exists(l),ind>-1?((l=point_list[ind]).lab[0]==l_value?(remove_previous_selected(),selected_point_index=ind,draw_selected_point(),select_point_list.selectedIndex=selected_point_index):(set_l_to_current_point(l.lab[0]),selected_point_index=ind,draw_points(),select_point_list.selectedIndex=selected_point_index),draw_color_pattern()):point_lies_inside_boundry(l)?(create_new_point(l),remove_previous_selected(),draw_graph()):(remove_previous_selected(),draw_color_pattern(),select_point_list.selectedIndex=-1)},!1),canvas.addEventListener("dbclick",function(e){var t=canvas.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top;c.font="10pt Calibri",c.fillStyle="black",c.fillRect(0,0,70,20),c.fillStyle="white",c.fillText("DClicked",5,14),lab=[l_value,getA(i),getB(n)],rgb=labTOrgb(lab);var l={};l.xy=[i,n],l.lab=lab,l.rgb=rgb,ind=point_exists(l),ind>-1&&(remove_previous_selected(),selected_point_index=ind,draw_selected_point())},!1),canvas.addEventListener("mousedown",function(e){mouse_pressed=!0},!1),canvas.addEventListener("mouseup",function(e){mouse_pressed=!1},!1),da=200/canvas.width,db=200/canvas.height;
