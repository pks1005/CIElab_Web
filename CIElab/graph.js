var graph_canvas=document.getElementById("graph"),graph_context=graph_canvas.getContext("2d");graph_canvas.width=550,graph_canvas.height=400;var margin_left=50,margin_top=50,dE=0,pre_dE=0;draw_graph=function(){var a=point_list.length;if(graph_context.clearRect(0,0,graph_canvas.width,graph_canvas.height),0!=a){var t=Math.floor((graph_canvas.width-margin_left)/a);if(draw_outline(),draw_hori_lines(),td=0,a>1){for(var r=1;r<a;r++)(dE=Math.sqrt(Math.pow(point_list[r].lab[0]-point_list[r-1].lab[0],2)+Math.pow((point_list[r].lab[1]-point_list[r-1].lab[1])*CIElab_A_WEIGHT,2)+Math.pow((point_list[r].lab[2]-point_list[r-1].lab[2])*CIElab_B_WEIGHT,2)))>pre_dE&&(pre_dE=dE),td+=dE;var n=Math.floor(pre_dE/10)+1;graph_context.fillStyle=graph_y_label_color;for(r=0;r<10;r++)graph_context.fillText(""+n*(10-r),margin_left-24,margin_top+(graph_canvas.height-margin_top)/10*r+5);graph_context.fillText("0",margin_left-24,graph_canvas.height);var i=(graph_canvas.height-margin_top)/n/10;pre_dE=0;for(r=1;r<a;r++)dE=Math.sqrt(Math.pow(point_list[r].lab[0]-point_list[r-1].lab[0],2)+Math.pow((point_list[r].lab[1]-point_list[r-1].lab[1])*CIElab_A_WEIGHT,2)+Math.pow((point_list[r].lab[2]-point_list[r-1].lab[2])*CIElab_B_WEIGHT,2)),draw_line(margin_left+t*r,margin_top,margin_left+t*r,graph_canvas.height-1,graph_vert_line_color,graph_context),draw_point(t*r+margin_left,margin_top+Math.floor(graph_canvas.height-margin_top-dE*i),6,graph_point_color,graph_context),r>1&&draw_line(t*(r-1)+margin_left,margin_top+Math.floor(graph_canvas.height-margin_top-pre_dE*i),t*r+margin_left,margin_top+Math.floor(graph_canvas.height-margin_top-dE*i),graph_line_color,graph_context),pre_dE=dE}td<1e-4?td=0:(td=Math.floor(td)+Math.floor(10*(td-Math.floor(td)))/10,graph_context.fillStyle="#55aaaa",graph_context.fillText("Total Discrimination: "+td,graph_canvas.width/2-60,30))}},draw_outline=function(){graph_context.font="11pt Calibri",graph_context.fillStyle=graph_text_color,draw_rect(margin_left,margin_top,graph_canvas.width-margin_left-1,graph_canvas.height-margin_top-1,"#000000",graph_context),graph_context.fillText("Colormap Uniformity",graph_canvas.width/2.4,14),graph_context.fillText("dE",5,graph_canvas.height/2)},draw_hori_lines=function(){for(var a=0;a<10;a++)draw_line(margin_left+1,margin_top+(graph_canvas.height-margin_top)/10*a,graph_canvas.width-1,margin_top+(graph_canvas.height-margin_top)/10*a,graph_hori_line_color,graph_context)},graph_canvas.addEventListener("click",function(a){var t=canvas.getBoundingClientRect();a.clientX,t.left,a.clientY,t.top;graph_context.fillRect(0,0,70,20),graph_context.fillStyle="white",graph_context.fillText("Clicked",5,14),draw_graph()},!1),canvas.addEventListener("dbclick",function(a){},!1),canvas.addEventListener("mousedown",function(a){},!1),canvas.addEventListener("mouseup",function(a){},!1),graph_canvas.addEventListener("mousemove",function(a){},!1);
